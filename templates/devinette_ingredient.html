{% extends "devinette_base.html" %}
{% set active_tab = 'ingredient' %}

{% block game_content %}
<div class="py-10 flex flex-col items-center min-h-screen bg-gray-50">

  <!-- Cocktail mystÃ¨re -->
  {% if cocktail_image %}
  <div class="flex flex-col items-center mb-6">
    <img src="{{ cocktail_image }}" alt="Cocktail mystÃ¨re"
         class="w-48 h-48 object-cover rounded-lg border shadow mb-3">
    <span class="font-semibold text-gray-600 text-sm italic">
      Devine les ingrÃ©dients du cocktail mystÃ¨re : <b>{{ cocktail }}</b>
    </span>
  </div>
  {% endif %}

  {% if message %}
    <div class="bg-green-100 text-green-800 px-5 py-3 rounded-xl font-semibold mb-6 shadow text-center">
      {{ message }}
    </div>
  {% endif %}

  <!-- Champ de saisie d'ingrÃ©dient -->
  <form method="POST" class="mb-6 flex flex-row gap-2 w-full max-w-xl">
    <label for="ingredient" class="sr-only">Nom de l'ingrÃ©dient</label>
    <input id="ingredient" name="ingredient" type="text"
           class="flex-1 px-4 py-2 border rounded"
           placeholder="Ex : vodka, citron, sucre..." required>
    <button type="submit"
            class="px-5 py-2 bg-blue-600 text-white rounded-lg">Valider</button>
  </form>
<form method="POST">
    <button type="submit" name="reset" value="1">ğŸ”„ Recommencer</button>
</form>

  <!-- Historique des essais -->
  <div class="w-full max-w-2xl space-y-4">
  {% if attempts %}
    {% for at in attempts|reverse %}
      <div class="flex flex-col bg-gray-100 rounded-xl shadow p-4 gap-3">
        <div class="flex items-center gap-4">
          <span class="font-semibold text-lg text-gray-800 italic">{{ at.raw_input }}</span>
        </div>

        <div class="flex flex-wrap gap-3">
          {% for fb in at.user_ingredients %}
          <div class="flex flex-col items-center text-center">
            {% if fb.img %}
              <img src="{{ fb.img }}" alt="{{ fb.ingredient }}"
                   class="w-16 h-16 object-cover rounded-full border shadow">
            {% else %}
              <div class="w-16 h-16 rounded-full flex items-center justify-center text-gray-500 bg-gray-200">?</div>
            {% endif %}
            <span class="mt-1 text-sm font-semibold
              {% if fb.status == 'good' %}text-green-700{% else %}text-red-600{% endif %}">
              {{ fb.ingredient }}
            </span>
          </div>
          {% endfor %}
        </div>
      </div>
    {% endfor %}
  {% else %}
    <p class="text-gray-500 italic text-sm text-center">Aucune tentative encore...</p>
  {% endif %}
  </div>
</div>
{% endblock %}
